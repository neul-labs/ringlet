import{d as P,H as U,C as z,o as W,k as x,y as T,c as d,b as t,l as h,p as $,q as L,F as p,r as k,t as a,f as A,j as D,e as S,n as N,w as q,h as E,i as l}from"./index-CKP-FecI.js";import{_ as H}from"./LoadingSpinner.vue_vue_type_script_setup_true_lang-BF-cP9Dh.js";const Y={class:"flex items-center justify-between mb-6"},G={class:"flex items-center gap-4"},J=["value"],K=["value"],Q=["disabled"],X={key:0,class:"flex justify-center py-12"},Z={key:1,class:"bg-red-50 dark:bg-red-900/50 text-red-700 dark:text-red-300 p-4 rounded-lg"},tt={key:2,class:"space-y-6"},et={class:"text-sm text-gray-500 dark:text-gray-400"},st={class:"font-medium text-gray-700 dark:text-gray-200"},at={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"},ot={class:"bg-white dark:bg-gray-800 rounded-lg shadow p-6"},rt={class:"text-3xl font-bold text-blue-600 mt-2"},dt={class:"text-xs text-gray-400 mt-1"},lt={class:"bg-white dark:bg-gray-800 rounded-lg shadow p-6"},it={class:"text-3xl font-bold text-green-600 mt-2"},nt={key:0,class:"text-xs text-gray-400 mt-1"},ut={key:1,class:"text-xs text-gray-400 mt-1"},gt={class:"bg-white dark:bg-gray-800 rounded-lg shadow p-6"},xt={class:"text-3xl font-bold text-purple-600 mt-2"},ct={class:"bg-white dark:bg-gray-800 rounded-lg shadow p-6"},yt={class:"text-3xl font-bold text-orange-600 mt-2"},vt={class:"bg-white dark:bg-gray-800 rounded-lg shadow"},_t={class:"p-6"},pt={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},kt={class:"text-xl font-semibold text-gray-900 dark:text-white"},mt={class:"text-xl font-semibold text-gray-900 dark:text-white"},bt={class:"text-xl font-semibold text-gray-900 dark:text-white"},ht={class:"text-xl font-semibold text-gray-900 dark:text-white"},ft={key:0,class:"bg-white dark:bg-gray-800 rounded-lg shadow"},wt={class:"p-6"},Ct={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},Tt={class:"text-xl font-semibold text-green-600"},$t={class:"text-xl font-semibold text-green-600"},Lt={class:"text-xl font-semibold text-green-600"},At={class:"text-xl font-semibold text-green-600"},Dt={key:1,class:"bg-white dark:bg-gray-800 rounded-lg shadow"},St={class:"p-6"},Nt={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Ot={class:"flex items-center justify-between"},Vt={class:"text-sm text-gray-500 dark:text-gray-400"},jt={class:"mt-3 grid grid-cols-2 gap-2 text-sm"},Bt={class:"font-medium text-gray-900 dark:text-white"},It={class:"font-medium text-gray-900 dark:text-white"},Mt={class:"mt-2 text-xs text-gray-400"},Rt={class:"bg-white dark:bg-gray-800 rounded-lg shadow"},Ft={key:0,class:"p-6 text-center text-gray-500 dark:text-gray-400"},Pt={key:1,class:"overflow-x-auto"},Ut={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},zt={class:"divide-y divide-gray-200 dark:divide-gray-700"},Wt={class:"px-6 py-4 whitespace-nowrap"},qt={class:"px-6 py-4 whitespace-nowrap text-right text-gray-500 dark:text-gray-400"},Et={class:"px-6 py-4 whitespace-nowrap text-right text-gray-500 dark:text-gray-400"},Ht={class:"px-6 py-4 whitespace-nowrap text-right text-gray-500 dark:text-gray-400"},Yt={class:"px-6 py-4 whitespace-nowrap text-right text-gray-500 dark:text-gray-400"},Qt=P({__name:"UsageView",setup(Gt){const o=x(null),m=x(!0),c=x(null),b=x("today"),f=x("all"),_=x(!1),O=U(),V=[{value:"today",label:"Today"},{value:"yesterday",label:"Yesterday"},{value:"week",label:"This Week"},{value:"month",label:"This Month"},{value:"7d",label:"Last 7 Days"},{value:"30d",label:"Last 30 Days"},{value:"all",label:"All Time"}],j=[{value:"all",label:"All Agents"},{value:"claude",label:"Claude Code"},{value:"codex",label:"Codex CLI"},{value:"opencode",label:"OpenCode"}];z(()=>O.recentEvents,s=>{const e=s[s.length-1];(e==null?void 0:e.type)==="usage_updated"&&y()},{deep:!0}),W(async()=>{await y()});async function y(){m.value=!0,c.value=null;try{o.value=await T.usage.get({period:b.value})}catch(s){c.value=s.message}finally{m.value=!1}}async function B(){_.value=!0;try{await T.usage.importClaude(),await y()}catch(s){c.value=s.message}finally{_.value=!1}}function i(s){return new Intl.NumberFormat().format(s)}function n(s){return s<.01?`$${s.toFixed(4)}`:`$${s.toFixed(2)}`}function I(s){if(s<60)return`${s}s`;if(s<3600)return`${Math.floor(s/60)}m ${s%60}s`;const e=Math.floor(s/3600),u=Math.floor(s%3600/60);return`${e}h ${u}m`}function v(s){return s.input_tokens+s.output_tokens+s.cache_creation_input_tokens+s.cache_read_input_tokens}const w=S(()=>o.value?Object.entries(o.value.aggregates.by_profile).sort(([,s],[,e])=>e.sessions-s.sessions):[]),C=S(()=>{var s;return(s=o.value)!=null&&s.aggregates.by_agent?Object.entries(o.value.aggregates.by_agent).map(([e,u])=>({key:e,...u})).sort((e,u)=>v(u.tokens)-v(e.tokens)):[]});function M(s){return{claude:"Claude Code",codex:"Codex CLI",opencode:"OpenCode"}[s]||s}function R(s){return{claude:"text-amber-600",codex:"text-emerald-600",opencode:"text-sky-600"}[s]||"text-gray-600"}function F(s){return{claude:"bg-amber-50 dark:bg-amber-900/20",codex:"bg-emerald-50 dark:bg-emerald-900/20",opencode:"bg-sky-50 dark:bg-sky-900/20"}[s]||"bg-gray-50 dark:bg-gray-900/20"}return(s,e)=>{const u=E("RouterLink");return l(),d("div",null,[t("div",Y,[e[2]||(e[2]=t("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Usage",-1)),t("div",G,[$(t("select",{"onUpdate:modelValue":e[0]||(e[0]=r=>b.value=r),class:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white",onChange:y},[(l(),d(p,null,k(V,r=>t("option",{key:r.value,value:r.value},a(r.label),9,J)),64))],544),[[L,b.value]]),$(t("select",{"onUpdate:modelValue":e[1]||(e[1]=r=>f.value=r),class:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white"},[(l(),d(p,null,k(j,r=>t("option",{key:r.value,value:r.value},a(r.label),9,K)),64))],512),[[L,f.value]]),t("button",{class:"px-4 py-2 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",onClick:y}," Refresh "),t("button",{class:"px-4 py-2 bg-blue-600 text-white hover:bg-blue-700 rounded-lg transition-colors disabled:opacity-50",disabled:_.value,onClick:B},a(_.value?"Importing...":"Import Claude Data"),9,Q)])]),m.value?(l(),d("div",X,[A(H,{size:"lg"})])):c.value?(l(),d("div",Z,a(c.value),1)):o.value?(l(),d("div",tt,[t("div",et,[e[3]||(e[3]=D(" Showing data for: ",-1)),t("span",st,a(o.value.period),1)]),t("div",at,[t("div",ot,[e[4]||(e[4]=t("div",{class:"text-sm font-medium text-gray-500 dark:text-gray-400"},"Total Tokens",-1)),t("div",rt,a(i(v(o.value.total_tokens))),1),t("div",dt,a(i(o.value.total_tokens.input_tokens))+" in / "+a(i(o.value.total_tokens.output_tokens))+" out ",1)]),t("div",lt,[e[5]||(e[5]=t("div",{class:"text-sm font-medium text-gray-500 dark:text-gray-400"},"Total Cost",-1)),t("div",it,a(o.value.total_cost?n(o.value.total_cost.total_cost):"-"),1),o.value.total_cost?(l(),d("div",nt,a(n(o.value.total_cost.input_cost))+" in / "+a(n(o.value.total_cost.output_cost))+" out ",1)):(l(),d("div",ut," Only tracked for direct API usage "))]),t("div",gt,[e[6]||(e[6]=t("div",{class:"text-sm font-medium text-gray-500 dark:text-gray-400"},"Sessions",-1)),t("div",xt,a(i(o.value.total_sessions)),1)]),t("div",ct,[e[7]||(e[7]=t("div",{class:"text-sm font-medium text-gray-500 dark:text-gray-400"},"Runtime",-1)),t("div",yt,a(I(o.value.total_runtime_secs)),1)])]),t("div",vt,[e[12]||(e[12]=t("div",{class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},[t("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Token Breakdown")],-1)),t("div",_t,[t("div",pt,[t("div",null,[e[8]||(e[8]=t("div",{class:"text-sm text-gray-500 dark:text-gray-400"},"Input",-1)),t("div",kt,a(i(o.value.total_tokens.input_tokens)),1)]),t("div",null,[e[9]||(e[9]=t("div",{class:"text-sm text-gray-500 dark:text-gray-400"},"Output",-1)),t("div",mt,a(i(o.value.total_tokens.output_tokens)),1)]),t("div",null,[e[10]||(e[10]=t("div",{class:"text-sm text-gray-500 dark:text-gray-400"},"Cache Creation",-1)),t("div",bt,a(i(o.value.total_tokens.cache_creation_input_tokens)),1)]),t("div",null,[e[11]||(e[11]=t("div",{class:"text-sm text-gray-500 dark:text-gray-400"},"Cache Read",-1)),t("div",ht,a(i(o.value.total_tokens.cache_read_input_tokens)),1)])])])]),o.value.total_cost?(l(),d("div",ft,[e[17]||(e[17]=t("div",{class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},[t("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Cost Breakdown")],-1)),t("div",wt,[t("div",Ct,[t("div",null,[e[13]||(e[13]=t("div",{class:"text-sm text-gray-500 dark:text-gray-400"},"Input",-1)),t("div",Tt,a(n(o.value.total_cost.input_cost)),1)]),t("div",null,[e[14]||(e[14]=t("div",{class:"text-sm text-gray-500 dark:text-gray-400"},"Output",-1)),t("div",$t,a(n(o.value.total_cost.output_cost)),1)]),t("div",null,[e[15]||(e[15]=t("div",{class:"text-sm text-gray-500 dark:text-gray-400"},"Cache Creation",-1)),t("div",Lt,a(n(o.value.total_cost.cache_creation_cost)),1)]),t("div",null,[e[16]||(e[16]=t("div",{class:"text-sm text-gray-500 dark:text-gray-400"},"Cache Read",-1)),t("div",At,a(n(o.value.total_cost.cache_read_cost)),1)])])])])):h("",!0),C.value.length>0?(l(),d("div",Dt,[e[20]||(e[20]=t("div",{class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},[t("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Usage by Agent")],-1)),t("div",St,[t("div",Nt,[(l(!0),d(p,null,k(C.value,r=>(l(),d("div",{key:r.key,class:N([F(r.key),"rounded-lg p-4"])},[t("div",Ot,[t("span",{class:N(["font-semibold",R(r.key)])},a(M(r.key)),3),t("span",Vt,a(i(r.sessions))+" sessions ",1)]),t("div",jt,[t("div",null,[e[18]||(e[18]=t("div",{class:"text-gray-500 dark:text-gray-400"},"Tokens",-1)),t("div",Bt,a(i(v(r.tokens))),1)]),t("div",null,[e[19]||(e[19]=t("div",{class:"text-gray-500 dark:text-gray-400"},"Cost",-1)),t("div",It,a(r.cost?n(r.cost.total_cost):"-"),1)])]),t("div",Mt,a(i(r.tokens.input_tokens))+" in / "+a(i(r.tokens.output_tokens))+" out ",1)],2))),128))])])])):h("",!0),t("div",Rt,[e[22]||(e[22]=t("div",{class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},[t("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Usage by Profile")],-1)),w.value.length===0?(l(),d("div",Ft," No profile usage data available ")):(l(),d("div",Pt,[t("table",Ut,[e[21]||(e[21]=t("thead",{class:"bg-gray-50 dark:bg-gray-900"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Profile"),t("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Sessions"),t("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Tokens"),t("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Cost"),t("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Last Used")])],-1)),t("tbody",zt,[(l(!0),d(p,null,k(w.value,([r,g])=>(l(),d("tr",{key:r},[t("td",Wt,[A(u,{to:`/profiles/${r}`,class:"font-medium text-blue-600 hover:text-blue-700"},{default:q(()=>[D(a(r),1)]),_:2},1032,["to"])]),t("td",qt,a(i(g.sessions)),1),t("td",Et,a(i(v(g.tokens))),1),t("td",Ht,a(g.cost?n(g.cost.total_cost):"-"),1),t("td",Yt,a(g.last_used?new Date(g.last_used).toLocaleDateString():"-"),1)]))),128))])])]))])])):h("",!0)])}}});export{Qt as default};
